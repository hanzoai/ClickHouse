<clickhouse>
    <!-- Hanzo Datastore Configuration -->

    <!-- Memory limits -->
    <max_memory_usage>10000000000</max_memory_usage>
    <max_bytes_before_external_group_by>5000000000</max_bytes_before_external_group_by>

    <!-- Aggregation optimization -->
    <distributed_aggregation_memory_efficient>1</distributed_aggregation_memory_efficient>

    <!-- Query settings -->
    <max_execution_time>300</max_execution_time>
    <max_threads>8</max_threads>

    <!-- Background processing -->
    <background_pool_size>16</background_pool_size>
    <background_schedule_pool_size>16</background_schedule_pool_size>

    <!-- Compression -->
    <compression>
        <case>
            <min_part_size>10000000000</min_part_size>
            <min_part_size_ratio>0.01</min_part_size_ratio>
            <method>zstd</method>
            <level>3</level>
        </case>
    </compression>

    <!-- Logging -->
    <logger>
        <level>information</level>
        <log>/var/log/clickhouse-server/clickhouse-server.log</log>
        <errorlog>/var/log/clickhouse-server/clickhouse-server.err.log</errorlog>
        <size>1000M</size>
        <count>10</count>
    </logger>

    <!-- HTTP interface settings -->
    <http_server_default_response>
        <![CDATA[<html><body>Hanzo Datastore (ClickHouse)</body></html>]]>
    </http_server_default_response>

    <!-- Prometheus metrics endpoint -->
    <prometheus>
        <endpoint>/metrics</endpoint>
        <port>9363</port>
        <metrics>true</metrics>
        <events>true</events>
        <asynchronous_metrics>true</asynchronous_metrics>
    </prometheus>
</clickhouse>
